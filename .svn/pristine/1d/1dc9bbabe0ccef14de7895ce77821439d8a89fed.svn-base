import { FETCH_ALL_SANATEXT } from "../../action-types";
import { UPDATE_SANATEXT_SATE } from "../../mutation-types";
import contentApi from "../../../api/content-api";
import sesionManager from "../../../helpers/session-manager";
import config from "../../../config.json";

export default {
  // fetch sanatext reult
  // calling APi if cookie not exsist
  [FETCH_ALL_SANATEXT]: context => new Promise((resolve, reject) => {
    if (!sesionManager.chekcCookieExsitst(config.Cookiekeys.SanaText)) {
      contentApi
        .getAllSanaText()
        .then((searchResult) => {
          context.commit(UPDATE_SANATEXT_SATE, searchResult);
          sesionManager.setCookie(config.Cookiekeys.SanaText, 1);
          resolve();
        })
        .catch((error) => {
          reject();
          throw error;
        });
    }
  })
};
