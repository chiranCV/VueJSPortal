<template>
  <sana-dropdown
    v-bind:DataList="this.languages"
    IdField="Id"
    TextField="Text"
    v-bind:PreSelectedItemId="this.selectedItemId"
    v-on:onChangeSelection="onChangeSelection"
  ></sana-dropdown>
</template>

<script>
import GlobalHelper from "../../helpers/GlobalHelper";
import Dropdown from "./ui/Dropdown.vue";

export default {
  name: "LanguageSelector",
  components: {
    "sana-dropdown": Dropdown
  },
  data() {
    return {
      languages: [],
      selectedItemId: ""
    };
  },
  created() {
    this.getSortOptions();
    this.selectedItemId = GlobalHelper.getLanguageId();
  },
  methods: {
    getSortOptions() {
      const languageData = GlobalHelper.getShopLanguages();
      const items = [];
      if (languageData.Languages.length > 0) {
        languageData.Languages.forEach((item) => {
          items.push({
            Id: item.Id.toString(),
            Text: item.Name,
            Text: `<span class="lng-flag language_${item.Id}"><span class="lng-text">${
              item.Name? item.Name: item.Id
              } </span></span>`,
            InnerHtml: ""
          });
        });
      }
      this.languages = items;

      if (!GlobalHelper.getLanguageId()) {
        GlobalHelper.setLanguageId(languageData.SelectedId);
      }

      return this.languages;
    },
    onChangeSelection(data) {
      debugger;
      GlobalHelper.setLanguageId(data.Id);
    }
  }
};
</script>
